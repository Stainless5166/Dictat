# Dictat Environment Configuration
# Copy this file to .env and fill in your actual values

# ============================================================================
# Application Settings
# ============================================================================
APP_NAME=Dictat
APP_VERSION=0.1.0
APP_ENV=development  # development, staging, production
DEBUG=True
LOG_LEVEL=INFO  # DEBUG, INFO, WARNING, ERROR, CRITICAL

# ============================================================================
# Server Configuration
# ============================================================================
HOST=0.0.0.0
PORT=8000
RELOAD=True  # Auto-reload on code changes (development only)

# ============================================================================
# Security & Authentication
# ============================================================================
SECRET_KEY=your-secret-key-here-change-in-production-min-32-chars
ALGORITHM=HS256
ACCESS_TOKEN_EXPIRE_MINUTES=30
REFRESH_TOKEN_EXPIRE_DAYS=7

# Password Hashing
PASSWORD_HASH_ALGORITHM=argon2  # bcrypt or argon2

# CORS Origins (comma-separated)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# ============================================================================
# Database Configuration (PostgreSQL)
# ============================================================================
DB_HOST=localhost
DB_PORT=5432
DB_USER=dictat_user
DB_PASSWORD=your-db-password-here
DB_NAME=dictat_db
DB_ECHO=False  # Set to True to see SQL queries in logs

# Connection Pool Settings
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# Full Database URL (alternative to individual settings)
# DATABASE_URL=postgresql+asyncpg://dictat_user:password@localhost:5432/dictat_db

# ============================================================================
# Redis Configuration
# ============================================================================
REDIS_HOST=localhost
REDIS_PORT=6379
REDIS_PASSWORD=
REDIS_DB=0
REDIS_CACHE_TTL=3600  # seconds

# Full Redis URL (alternative)
# REDIS_URL=redis://:password@localhost:6379/0

# ============================================================================
# Open Policy Agent (OPA)
# ============================================================================
OPA_URL=http://localhost:8181
OPA_POLICY_PATH=/v1/data/dictat/allow
OPA_TIMEOUT=5  # seconds

# ============================================================================
# File Storage (Docker Volumes)
# ============================================================================
STORAGE_BASE_PATH=/app/storage
AUDIO_STORAGE_PATH=/app/storage/audio
MAX_UPLOAD_SIZE=104857600  # 100MB in bytes
ALLOWED_AUDIO_FORMATS=mp3,wav,m4a,ogg,flac
CHUNK_SIZE=1048576  # 1MB for chunked uploads

# ============================================================================
# Email Configuration
# ============================================================================
MAIL_USERNAME=noreply@dictat.example.com
MAIL_PASSWORD=your-email-password
MAIL_FROM=noreply@dictat.example.com
MAIL_PORT=587
MAIL_SERVER=smtp.example.com
MAIL_TLS=True
MAIL_SSL=False
MAIL_USE_CREDENTIALS=True

# ============================================================================
# Background Tasks (Celery/ARQ)
# ============================================================================
CELERY_BROKER_URL=redis://localhost:6379/1
CELERY_RESULT_BACKEND=redis://localhost:6379/2
TASK_QUEUE_NAME=dictat_tasks

# ============================================================================
# WebSocket Configuration
# ============================================================================
WS_HEARTBEAT_INTERVAL=30  # seconds
WS_MESSAGE_QUEUE_SIZE=100

# ============================================================================
# Monitoring & Metrics
# ============================================================================
PROMETHEUS_ENABLED=True
PROMETHEUS_PORT=9090
METRICS_NAMESPACE=dictat

# Logging
LOG_FORMAT=json  # json or text
LOG_FILE=/app/logs/dictat.log
LOG_ROTATION=10 MB
LOG_RETENTION=30 days

# ============================================================================
# UK GDPR Compliance (Isle of Man)
# ============================================================================
DATA_RETENTION_DAYS=2555  # 7 years for medical records
AUDIT_LOG_RETENTION_DAYS=3650  # 10 years for audit trails
ENABLE_ENCRYPTION_AT_REST=True
ENABLE_FIELD_LEVEL_ENCRYPTION=True

# Data Protection Officer Contact
DPO_EMAIL=dpo@example.com
DPO_NAME=Data Protection Officer

# ============================================================================
# Rate Limiting
# ============================================================================
RATE_LIMIT_ENABLED=True
RATE_LIMIT_PER_MINUTE=60
RATE_LIMIT_PER_HOUR=1000

# ============================================================================
# Security Headers
# ============================================================================
HSTS_MAX_AGE=31536000
CSP_POLICY="default-src 'self'; script-src 'self' 'unsafe-inline'; style-src 'self' 'unsafe-inline'"

# ============================================================================
# Frontend Configuration
# ============================================================================
FRONTEND_URL=http://localhost:3000

# ============================================================================
# Digital Ocean (Production)
# ============================================================================
# DO_TOKEN=your-digital-ocean-api-token
# DO_REGION=lon1  # London datacenter (closest to Isle of Man)
# DO_DROPLET_SIZE=s-2vcpu-4gb
# DO_VOLUME_SIZE=100  # GB

# ============================================================================
# Terraform Configuration
# ============================================================================
# TF_STATE_BUCKET=dictat-terraform-state
# TF_STATE_KEY=dictat/production/terraform.tfstate

# ============================================================================
# Testing Configuration
# ============================================================================
TEST_DATABASE_URL=postgresql+asyncpg://test_user:test_password@localhost:5432/dictat_test
TEST_REDIS_URL=redis://localhost:6379/15

# ============================================================================
# Feature Flags
# ============================================================================
FEATURE_WEBSOCKET_ENABLED=True
FEATURE_EMAIL_NOTIFICATIONS=True
FEATURE_BACKGROUND_TASKS=True
FEATURE_METRICS_ENABLED=True
